<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>4教科特訓演習</title>
<style>
  body {
    margin: 0;
    background: #111;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: sans-serif;
  }

  #container {
    text-align: center;
  }
</style>
</head>
<body>

<div id="container">
  <input type="password" id="pw" placeholder="パスワード">
  <button onclick="check()">OK</button>
</div>

<script>
async function sha512(text) {
  const buf = new TextEncoder().encode(text);
  const hash = await crypto.subtle.digest('SHA-512', buf);
  return new Uint8Array(hash); // 512bit = 64バイト
}

// XOR復号
function xorDecrypt(data, key) {
  const result = new Uint8Array(data.length);
  for (let i = 0; i < data.length; i++) {
    result[i] = data[i] ^ key[i % key.length];
  }
  return new TextDecoder().decode(result);
}

const encryptedBase64 = "OhS1z+fHkRWUgLHjxnEvK0Cn08DYBtLy";

async function check() {
  const input = document.getElementById("pw").value;

  const key = await sha512(input);

  try {
    const encrypted = Uint8Array.from(atob(encryptedBase64), c => c.charCodeAt(0));
    const url = xorDecrypt(encrypted, key);

    if (!url.startsWith("http")) throw "error";

    launch(url);

  } catch {
    alert("違います");
  }
}

function launch(url) {
  document.body.innerHTML = "";

  const iframe = document.createElement("iframe");
  iframe.src = url;
  iframe.style.position = "fixed";
  iframe.style.inset = "0";
  iframe.style.border = "none";
  iframe.style.width = "100%";
  iframe.style.height = "100%";

  document.body.appendChild(iframe);
}
</script>

</body>
</html>
